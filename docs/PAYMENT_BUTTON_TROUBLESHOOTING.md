# 결제 버튼 작동 안 함 문제 해결 가이드

## 🔍 문제: 결제하기 버튼이 작동하지 않음

결제하기 버튼을 클릭해도 아무 반응이 없거나, 버튼이 비활성화되어 있는 경우 해결 방법입니다.

---

## ✅ 해결 방법

### 1단계: 브라우저 콘솔 확인

1. **개발자 도구 열기 (F12)**
2. **Console 탭 확인**
3. **결제 버튼 클릭**
4. **에러 메시지 확인**

다음과 같은 로그가 표시되어야 합니다:

```
환경 변수 확인 성공: {
  storeIdExists: true,
  channelKeyExists: true,
  siteUrlExists: true
}
포트원 SDK 로드 시작...
포트원 SDK 로드 성공: {...}
```

### 2단계: 환경 변수 확인

브라우저에서 다음 URL 접속:
```
https://parplay.co.kr/api/payment/check-env
```

다음과 같은 응답이 나와야 합니다:
```json
{
  "success": true,
  "storeIdExists": true,
  "channelKeyExists": true,
  "siteUrlExists": true
}
```

만약 `success: false`이면:
- Vercel에 환경 변수가 설정되지 않았습니다
- Vercel 대시보드에서 환경 변수를 확인하세요

### 3단계: Vercel 환경 변수 확인

1. **Vercel 대시보드 접속**
   - https://vercel.com
   - 프로젝트 선택

2. **Settings → Environment Variables**
   - 다음 변수들이 있는지 확인:
     - `NEXT_PUBLIC_PORTONE_STORE_ID`
     - `NEXT_PUBLIC_PORTONE_CHANNEL_KEY`
     - `NEXT_PUBLIC_SITE_URL`

3. **Production 환경에 체크되어 있는지 확인**

4. **배포 재시작**
   - Deployments → 최신 배포 → "..." → "Redeploy"

---

## 🔧 버튼 상태 확인

### 버튼이 비활성화되어 있는 경우

버튼이 회색으로 표시되고 클릭할 수 없는 경우:

**원인:**
- 포트원 SDK가 아직 로드되지 않음
- 환경 변수가 설정되지 않음

**해결:**
1. 페이지 새로고침 (Ctrl+Shift+R 또는 Cmd+Shift+R)
2. 브라우저 콘솔에서 에러 확인
3. Vercel 환경 변수 확인

### 버튼을 클릭해도 아무 반응이 없는 경우

**원인:**
- JavaScript 에러 발생
- 이벤트 핸들러가 실행되지 않음

**해결:**
1. 브라우저 콘솔에서 에러 확인
2. 네트워크 탭에서 API 요청 확인
3. 페이지 새로고침

---

## 🐛 디버깅 단계

### Step 1: 브라우저 콘솔 확인

1. 개발자 도구 열기 (F12)
2. Console 탭
3. 결제 버튼 클릭
4. 다음 로그 확인:

```
환경 변수 확인 성공: {...}
포트원 SDK 로드 시작...
포트원 SDK 로드 성공: {...}
포트원 결제 요청: {...}
```

### Step 2: 네트워크 탭 확인

1. 개발자 도구 → Network 탭
2. 결제 버튼 클릭
3. 다음 요청이 있는지 확인:
   - `/api/payment/check-env`
   - 포트원 SDK 요청

### Step 3: 환경 변수 API 확인

브라우저에서 직접 접속:
```
https://parplay.co.kr/api/payment/check-env
```

응답 확인:
- `success: true` → 환경 변수 정상
- `success: false` → 환경 변수 설정 필요

---

## ⚠️ 자주 발생하는 문제

### 문제 1: 버튼이 계속 "결제 시스템 준비 중..." 상태

**원인:** 포트원 SDK가 로드되지 않음

**해결:**
1. 브라우저 콘솔에서 에러 확인
2. 네트워크 연결 확인
3. 페이지 새로고침

### 문제 2: "환경 변수를 확인하는 중입니다" 메시지

**원인:** 환경 변수 확인 API가 실패함

**해결:**
1. `/api/payment/check-env` 직접 접속하여 확인
2. Vercel 환경 변수 확인
3. 배포 재시작

### 문제 3: 버튼 클릭 시 아무 일도 일어나지 않음

**원인:** JavaScript 에러 또는 이벤트 핸들러 문제

**해결:**
1. 브라우저 콘솔에서 에러 확인
2. 다른 JavaScript 에러가 있는지 확인
3. 페이지 새로고침

---

## 📋 체크리스트

다음 항목을 확인하세요:

- [ ] 브라우저 콘솔에 에러가 없음
- [ ] `/api/payment/check-env` API가 `success: true` 반환
- [ ] Vercel에 환경 변수가 설정되어 있음
- [ ] 배포가 최신 상태임
- [ ] 브라우저 캐시를 삭제하고 테스트함
- [ ] 다른 브라우저에서도 테스트함

---

## 🚀 빠른 해결 방법

1. **브라우저 새로고침** (Ctrl+Shift+R 또는 Cmd+Shift+R)
2. **브라우저 콘솔 확인** (F12 → Console)
3. **에러 메시지 확인**
4. **Vercel 환경 변수 확인**
5. **배포 재시작** (필요한 경우)

---

## 💡 팁

- 브라우저 콘솔에서 "포트원 SDK 로드 성공" 메시지가 보이면 SDK가 정상적으로 로드된 것입니다
- 버튼이 비활성화되어 있으면 포트원 SDK가 아직 로드되지 않은 것입니다
- 환경 변수는 Vercel에서 설정한 후 반드시 배포를 재시작해야 합니다

**문제가 계속되면 브라우저 콘솔의 에러 메시지를 확인하세요!**










